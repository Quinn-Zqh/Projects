I=imread('C:\Users\嗜血\Desktop\A.jpeg');
I=rgb2gray(I);subplot(231);imshow(I,[]);title('原图');
PSF=fspecial('motion',25,11);
Blurred=imfilter(I,PSF,'conv','circular');
Noise=0.1*randn(size(I));
BlurredNoisy=imadd(Blurred,im2uint8(Noise));
subplot(232);imshow(BlurredNoisy,[]);title('运动模糊且加噪声后图像');
WI1=deconvwnr(BlurredNoisy,PSF);
subplot(233);imshow(WI1,[]);title('逆滤波复原结果');
NSR=sum(Noise(:).^2)/sum(im2double(I(:)).^2);
WI2=deconvwnr(BlurredNoisy,PSF,NSR);
subplot(234);imshow(WI2,[]);title('带噪信比参数维纳滤波复原结果');
NP=abs(fftn(Noise)).^2;
NCORR=real(ifftn(NP));
IP=abs(fftn(im2double(I))).^2;
ICORR=real(ifftn(IP));
WI3=deconvwnr(BlurredNoisy,PSF,NCORR,ICORR);
subplot(235);imshow(WI3,[]);title('带自相关函数的维纳滤波复原');