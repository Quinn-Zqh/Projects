f=rgb2gray(imread('C:\Users\嗜血\Desktop\z.jpg'));
f=im2double(f);
subplot(2,4,1);imshow(f),title('原图');
[M,N]=size(f);M2=2*M;N2=2*N;
F=fftshift(fft2(f,M2,N2));
subplot(2,4,2);imshow(mat2gray(log(1+abs(F))));title('傅里叶级数');
u=-N:N-1;v=-M:M-1;
[U,V]=meshgrid(u,v);
D=hypot(U,V);D0=60;
n=2;
H=1./(1+power((D0./D),(2*n)));
H=mat2gray(H);
subplot(2,4,3);imshow(H);title('理想高通滤波器');
fd=double(f);alpha=1;
hg=fspecial('gaussian',3,0.5);
fs=imfilter(fd,hg,'replicate');
h=fspecial('laplacian',0);
fL=imfilter(fd,h,'replicate');
g=fd-alpha*fL;
g(g<0)=0;g(g>255)=255;
g=uint8(g);
subplot(2,4,4);imshow(g);title('采用Laplacian锐化结果');
subplot(2,4,8);imshow(fL,[]);title('Laplacian二阶偏导图像')
G=F.*H;
subplot(2,4,5);imshow(mat2gray(log(1+abs(G))));title('频域滤波');
g0=ifft2(ifftshift(G));z=g0(1:M,1:N);z=real(z);
subplot(2,4,6);imshow(z);title('滤波后的图像');
i=histeq(z+f);
subplot(2,4,7);imshow(i);title('与原图叠加并eq后的图像');